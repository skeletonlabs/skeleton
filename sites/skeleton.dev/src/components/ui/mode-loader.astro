<script is:inline>
	function applyMode(document = window.document) {
		const storedMode = localStorage.getItem('mode');
		const preferredMode = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
		const defaultMode = 'dark';
		const mode = storedMode ?? preferredMode ?? defaultMode;
		localStorage.setItem('mode', mode);
		document.documentElement.setAttribute('data-mode', mode);
	}

	applyMode();

	document.addEventListener('astro:before-swap', (event) => {
		applyMode(event.newDocument);
	});
</script>
